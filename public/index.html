<!DOCTYPE html>
<html lang="fr" class="dark-theme">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus - Secure Private Chat</title>
    <meta name="description" content="A secure, private messaging application">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="style.css">
   
</head>
<body>
    <!-- Authentication Screens -->
    <div id="auth-container" class="auth-container">
        <!-- Login Card -->
        <div id="login-card" class="auth-card">
            <h1 class="auth-title">Connexion à Nexus</h1>
            <form id="login-form" class="auth-form">
                <div class="form-group">
                    <input type="text" id="login-username" class="form-input" placeholder=" " required autocomplete="username">
                    <label for="login-username" class="form-label">Nom d'utilisateur</label>
                </div>
                <div class="form-group">
                    <input type="password" id="login-password" class="form-input" placeholder=" " required autocomplete="current-password">
                    <label for="login-password" class="form-label">Mot de passe</label>
                </div>
                <button type="submit" class="auth-btn" id="login-btn">Se connecter</button>
            </form>
            <p class="auth-link">Pas de compte ? <a href="#" id="show-register">Créer un compte</a></p>
        </div>
        
        <!-- Registration Card -->
        <div id="register-card" class="auth-card hidden">
            <h1 class="auth-title">Créer un compte</h1>
            <form id="register-form" class="auth-form">
                <div class="avatar-upload">
                    <img id="avatar-preview" class="avatar-preview" src="https://i.pravatar.cc/150" alt="Avatar preview">
                    <label for="avatar-input" class="avatar-upload-label">Choisir une photo</label>
                    <input type="file" id="avatar-input" accept="image/*" class="hidden">
                </div>
                <div class="form-group">
                    <input type="text" id="register-name" class="form-input" placeholder=" " required>
                    <label for="register-name" class="form-label">Votre nom</label>
                </div>
                <div class="form-group">
                    <input type="text" id="register-username" class="form-input" placeholder=" " required autocomplete="username">
                    <label for="register-username" class="form-label">Nom d'utilisateur</label>
                </div>
                <div class="form-group">
                    <input type="password" id="register-password" class="form-input" placeholder=" " required autocomplete="new-password">
                    <label for="register-password" class="form-label">Mot de passe</label>
                </div>
                <button type="submit" class="auth-btn" id="register-btn">S'inscrire</button>
            </form>
            <p class="auth-link">Déjà un compte ? <a href="#" id="show-login">Se connecter</a></p>
        </div>
    </div>
    
    <!-- Main Application -->
    <div id="app-container" class="hidden">
        <!-- Sidebar -->
        <aside class="sidebar" aria-label="Navigation principale">
            <div class="sidebar-header">
                <h2 class="sidebar-title">Nexus Chat</h2>
                <button class="sidebar-close-btn" aria-label="Fermer la sidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- User Profile -->
            <div class="user-profile">
                <img id="user-avatar" class="user-avatar" src="https://i.pravatar.cc/150" alt="Votre avatar">
                <div class="user-info">
                    <div id="user-name" class="user-name">Chargement...</div>
                    <div id="user-username" class="user-username">@utilisateur</div>
                    <div class="user-status">
                        <span class="status-dot"></span>
                        <span>En ligne</span>
                    </div>
                </div>
            </div>
            
            <!-- Navigation -->
            <nav class="sidebar-nav" aria-label="Navigation secondaire">
                <a href="#" class="nav-item active" aria-current="page">
                    <i class="fas fa-comment-alt" aria-hidden="true"></i>
                    <span>Messages</span>
                </a>
                <a href="#" id="contacts-link" class="nav-item">
                    <i class="fas fa-user-friends" aria-hidden="true"></i>
                    <span>Contacts</span>
                </a>
                <a href="#" id="settings-link" class="nav-item">
                    <i class="fas fa-cog" aria-hidden="true"></i>
                    <span>Paramètres</span>
                </a>
                <button id="new-group-btn" class="nav-item">
                    <i class="fas fa-users" aria-hidden="true"></i>
                    <span>Nouveau groupe</span>
                </button>
            </nav>
            
            <!-- Groups and Contacts -->
            <h3 class="list-title">Groupes</h3>
            <div class="contacts-list" id="groups-list" role="list"></div>
            <h3 class="list-title">Contacts</h3>
            <div class="contacts-list" id="contacts-list" role="list"></div>
        </aside>
        
        <!-- Sidebar Overlay (Mobile) -->
        <div class="sidebar-overlay"></div>
        
        <!-- Main Chat Area -->
        <main class="chat-area">
            <!-- Chat Header -->
            <header class="chat-header">
                <button class="menu-btn" aria-label="Ouvrir le menu">
                    <i class="fas fa-bars"></i>
                </button>
                
                <div class="chat-partner">
                    <div class="chat-partner-avatar">
                        <img id="chat-partner-avatar" src="https://i.pravatar.cc/150?img=1" alt="Avatar de Jean">
                        <span id="chat-partner-status" class="contact-status online"></span>
                    </div>
                    <div class="chat-partner-info">
                        <div id="chat-partner-name" class="chat-partner-name">Jean Dupont</div>
                        <div id="chat-partner-status-text" class="chat-partner-status">
                            <span class="status-dot online"></span>
                            <span>En ligne</span>
                        </div>
                    </div>
                </div>
                
                <div class="chat-actions">
                    <button class="chat-action-btn call" aria-label="Appeler">
                        <i class="fas fa-phone-alt"></i>
                    </button>
                    <button class="chat-action-btn video" aria-label="Appel vidéo">
                        <i class="fas fa-video"></i>
                    </button>
                </div>
            </header>
            
            <!-- Messages Container -->
            <section id="messages-container" class="messages-container" aria-live="polite">
                <!-- Messages will be dynamically added here -->
                <div class="date-separator">Aujourd'hui</div>
                
                <div class="message received" role="listitem">
                    <div class="message-wrapper">
                        <div class="message-content">
                            Salut, comment ça va ?
                        </div>
                        <div class="message-info">
                            <span class="timestamp">12:30</span>
                        </div>
                    </div>
                </div>
                
                <div class="message sent" role="listitem">
                    <div class="message-wrapper">
                        <div class="message-content">
                            Ça va bien merci ! Et toi ?
                            <div class="message-actions">
                                <button class="message-action-btn" aria-label="Répondre">
                                    <i class="fas fa-reply"></i>
                                </button>
                                <button class="message-action-btn" aria-label="Réaction">
                                    <i class="fas fa-smile"></i>
                                </button>
                            </div>
                        </div>
                        <div class="message-info">
                            <span class="timestamp">12:32</span>
                            <i class="fas fa-check read-receipt read"></i>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Chat Input Area -->
            <footer class="chat-input-area">
                <form id="chat-form" class="chat-form">
                    <button type="button" class="action-btn" id="attach-btn" aria-label="Joindre un fichier">
                        <i class="fas fa-paperclip"></i>
                    </button>
                    <input type="file" id="file-input" class="hidden" accept="image/*,.pdf,.doc,.docx">
                    
                    <div class="input-group">
                        <div id="reply-preview" class="reply-preview hidden">
                            <div class="reply-preview-content" id="reply-snippet"></div>
                            <button type="button" class="cancel-reply" id="cancel-reply" aria-label="Annuler la réponse">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <textarea id="message-input" class="message-input" placeholder="Écrivez un message..." rows="1" aria-label="Message"></textarea>
                    </div>
                    
                    <select id="ttl-select" class="ttl-select" aria-label="Durée de vie du message">
                        <option value="">∞</option>
                        <option value="5000">5s</option>
                        <option value="60000">1m</option>
                        <option value="3600000">1h</option>
                    </select>
                    
                    <button type="submit" class="action-btn send-btn" id="send-btn" disabled aria-label="Envoyer le message">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </form>
            </footer>
        </main>
    </div>
    
    <!-- Call UI -->
    <div id="call-preview-container" class="call-ui hidden">
        <video id="preview-video" autoplay muted playsinline aria-hidden="true"></video>
        <div class="call-info">
            <div class="call-name" id="call-partner-name">Préparation de l'appel</div>
            <div class="call-status" id="call-status">Chargement de votre caméra...</div>
        </div>
        <div class="call-controls">
            <button class="control-btn hangup" id="hangup-preview-btn" aria-label="Raccrocher">
                <i class="fas fa-phone"></i>
            </button>
        </div>
    </div>
    
    <div id="call-container" class="call-ui hidden">
        <video id="remote-video" autoplay playsinline aria-label="Vidéo de votre contact"></video>
        <video id="local-video" autoplay muted playsinline aria-label="Votre vidéo"></video>
        <div class="call-info">
            <div class="call-name" id="call-partner-name">Jean Dupont</div>
            <div class="call-status" id="call-status">Appel en cours...</div>
        </div>
        <div class="call-controls">
            <button class="control-btn" id="mute-btn" aria-label="Couper le micro">
                <i class="fas fa-microphone"></i>
            </button>
            <button class="control-btn" id="video-btn" aria-label="Couper la caméra">
                <i class="fas fa-video"></i>
            </button>
            <button class="control-btn hangup" id="hangup-btn" aria-label="Raccrocher">
                <i class="fas fa-phone"></i>
            </button>
        </div>
    </div>
    
    <!-- Group Creation Modal -->
    <div id="group-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Créer un groupe</h3>
                <button class="modal-close" id="close-group-modal" aria-label="Fermer">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="create-group-form" class="auth-form">
                <div class="form-group">
                    <input type="text" id="group-name" class="form-input" placeholder=" " required>
                    <label for="group-name" class="form-label">Nom du groupe</label>
                </div>
                <div class="form-group">
                    <input type="text" id="group-avatar" class="form-input" placeholder=" ">
                    <label for="group-avatar" class="form-label">URL de l'avatar (optionnel)</label>
                </div>
                <div class="form-group">
                    <textarea id="group-members" class="form-input" placeholder=" " rows="3"></textarea>
                    <label for="group-members" class="form-label">Membres (séparés par des virgules)</label>
                </div>
                <button type="submit" class="auth-btn">Créer le groupe</button>
            </form>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>
    
    <!-- Audio Elements -->
    <audio id="message-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-software-interface-start-2574.mp3" preload="auto" crossorigin="anonymous"></audio>
    <audio id="call-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-waiting-ringtone-1354.mp3" loop preload="auto" crossorigin="anonymous"></audio>
    
    <!-- Socket.io -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="main.js" defer></script>
</body>
</html>